# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository as part of a comprehensive 12-agent institutional ecosystem for Pine Script v6 development.

## Repository Overview

This is a TradingView trading strategies repository focused on Pine Script v6 development operating within a **12-agent institutional ecosystem**. It contains educational trading strategies with comprehensive testing frameworks, primarily for cryptocurrency and forex markets. The repository emphasizes institutional-grade code quality, professional testing methodologies, and experimental strategy development through coordinated multi-agent collaboration.

## 12-Agent Institutional Ecosystem Integration

### Strategic Management Tier (MANDATORY FIRST CONSULTATION)

The strategic management tier provides institutional oversight and coordination for all development activities:

**Primary Strategic Agents**:
- **Context Manager** (Fletcher): Repository knowledge management, project context coordination, strategic documentation oversight
- **Project Manager** (Seldon): Epic breakdown, milestone planning, quality gate management, institutional delivery coordination
- **Agile Coach** (Herbie): Workflow facilitation, impediment removal, process optimization, team velocity management

**Strategic Consultation Protocol**:
```
ALL DEVELOPMENT WORKFLOWS MUST BEGIN WITH:
Context Manager → Project Manager → Agile Coach → [Specialized Agents]

NO direct specialized agent engagement without strategic tier approval
```

### Specialized Implementation Agents

**Technical Development Specialists**:
- **PineScript Specialist** (Bjarne): Pine Script v6 syntax, compilation, TradingView platform integration
- **Code Quality Auditor** (Margaret): Code review, quality standards, architectural compliance
- **Dynamic Risk Management** (Nassim): Risk assessment, position sizing, drawdown protection
- **Look-Ahead Bias Detection** (Andrew): Backtesting validity, temporal data integrity, statistical rigor

**Market Analysis Specialists**:
- **Market Structure Analyst** (Wyckoff): Price action analysis, market structure identification, trend analysis
- **Crypto Market Specialist** (Satoshi): Cryptocurrency market dynamics, digital asset trading patterns
- **Quantitative Performance Analyst** (Jim): Statistical analysis, performance metrics, backtesting validation
- **Strategy Implementation** (Ray): Strategy execution, portfolio management, systematic trading

**Quality Assurance & Communication**:
- **Designer** (Athena): Visualization, user interface design, data presentation optimization

### Multi-Agent Collaboration Workflows

#### Strategic Development Pipeline (Institutional-Grade)
```
Context Manager (Fletcher) → 
Project Manager (Seldon) → 
Agile Coach (Herbie) → 
PineScript Specialist (Bjarne) → 
Code Quality Auditor (Margaret) → 
Final Validation
```

#### Quality Assurance Pipeline (Enhanced Multi-Agent)
```
Context Manager (Fletcher) → 
Quantitative Performance Analyst (Jim) → 
Dynamic Risk Management (Nassim) → 
Look-Ahead Bias Detection (Andrew) → 
Strategy Implementation (Ray) → 
Institutional Deployment
```

#### Market Analysis Pipeline (Specialized Domain Expertise)
```
Context Manager (Fletcher) → 
Market Structure Analyst (Wyckoff) → 
Crypto Market Specialist (Satoshi) → 
Quantitative Performance Analyst (Jim) → 
Strategy Implementation (Ray)
```

#### Creative & Communication Pipeline
```
Context Manager (Fletcher) → 
Designer (Athena) → 
Code Quality Auditor (Margaret) → 
Final Presentation
```

## Implementation Priority Matrix Status

### Phase 1-4 Completed Deployment Status

**Phase 1: Foundation Architecture (COMPLETED)**
- 12-agent ecosystem deployment and integration
- Strategic management tier establishment
- Core workflow protocol implementation
- Institutional-grade quality gates activated

**Phase 2: Specialized Agent Integration (COMPLETED)**
- Domain-specific agent specialization deployment
- Multi-agent collaboration protocol refinement
- Quality assurance pipeline enhancement
- Performance validation systems integration

**Phase 3: Advanced Coordination Systems (COMPLETED)**
- Strategic consultation protocol enforcement
- Cross-agent communication optimization
- Institutional delivery pipeline establishment
- Quality gate automation implementation

**Phase 4: Operational Excellence (COMPLETED)**
- Full ecosystem operational status achieved
- All 12 agents actively coordinating
- Institutional-grade development standards enforced
- Strategic workflow patterns established and validated

**Current Operational Status**: All 12 agents fully operational with institutional coordination protocols active.

## Core Commands

### Multi-Agent Development Workflow Commands
```bash
# Strategic Project Navigation (Context Manager Coordination)
cd /home/rdelgado/Development/tradingview/testing-lab/ema-ribbon-macd-hybrid/  # Active development
cd /home/rdelgado/Development/tradingview/4h-swing-trading/                    # Production strategies
cd /home/rdelgado/Development/tradingview/5m-scalping-strategy/                # Production strategies

# Institutional File Management (Project Manager Oversight)
cp strategy-v1.pine strategy-v2.pine                                          # Version control
git add . && git commit -m "feat: implement new feature"                      # Version tracking
git status && git diff                                                        # Check changes

# Multi-Agent Code Review Workflow
# 1. Strategic consultation (Fletcher → Seldon → Herbie)
# 2. Development implementation (Bjarne specialization)
# 3. Quality validation (Margaret → Nassim → Andrew)
# 4. Performance analysis (Jim → Ray coordination)
# 5. Final institutional deployment validation
```

### Institutional Testing & Validation Commands
```bash
# Multi-Agent Pine Script Validation (TradingView Platform)
# 1. PineScript Specialist (Bjarne): Copy Pine Script code to TradingView editor
# 2. Code Quality Auditor (Margaret): Compile and check for errors/warnings (must be zero)
# 3. Quantitative Performance Analyst (Jim): Run backtest on multiple timeframes and markets
# 4. Look-Ahead Bias Detection (Andrew): Validate test suites within strategy code
# 5. Dynamic Risk Management (Nassim): Ensure all quality gates pass before production
# 6. Strategy Implementation (Ray): Final institutional deployment validation

# Institutional Quality Assurance Checklist
# - [ ] Zero Pine Script v6 compilation errors (Bjarne validation)
# - [ ] ≥90% test pass rate on both test suites (Margaret oversight)
# - [ ] Performance benchmarks met (Jim analysis)
# - [ ] Risk management controls validated (Nassim approval)
# - [ ] Look-ahead bias eliminated (Andrew verification)
# - [ ] Documentation complete and professional (Fletcher coordination)
# - [ ] Strategic alignment confirmed (Seldon approval)
```

### Agent Deployment Protocols

**Strategic Management Deployment**:
- **Context Manager Role**: Repository knowledge orchestration, strategic documentation oversight
- **Project Manager Role**: Epic decomposition, milestone coordination, institutional delivery management
- **Agile Coach Role**: Process facilitation, workflow optimization, impediment resolution

**Technical Implementation Deployment**:
- **PineScript Specialist Role**: Pine Script v6 syntax expertise, compilation management, TradingView integration
- **Code Quality Auditor Role**: Architectural compliance, quality standards enforcement, code review orchestration
- **Dynamic Risk Management Role**: Risk assessment protocols, position sizing optimization, drawdown protection systems
- **Look-Ahead Bias Detection Role**: Temporal data integrity, backtesting validity, statistical rigor enforcement

**Market Analysis Deployment**:
- **Market Structure Analyst Role**: Price action expertise, structural analysis, trend identification
- **Crypto Market Specialist Role**: Digital asset market dynamics, cryptocurrency trading pattern analysis
- **Quantitative Performance Analyst Role**: Statistical validation, performance metric analysis, backtesting coordination
- **Strategy Implementation Role**: Systematic execution, portfolio management, institutional deployment

## Architecture & Structure

### High-Level Multi-Agent Architecture
The repository follows a **12-agent coordinated strategy architecture** with these key components:

1. **Strategy Collection** (`/4h-swing-trading/`, `/5m-scalping-strategy/`)
   - Production-ready Pine Script v6 strategies with multi-agent validation
   - Each strategy validated through institutional 12-agent quality pipeline
   - Market Structure + MACD approaches with advanced multi-agent risk management coordination

2. **Testing Lab** (`/testing-lab/`)
   - Experimental strategy development environment with specialized agent oversight
   - Active development coordinated through strategic management tier
   - **Active Projects**: EMA Ribbon + MACD Hybrid v1.1 (multi-agent development coordination)
   - **Completed Projects**: BTC 5M True Scalping v1.0 (institutional graduation pipeline ready)
   - Paper trading only - graduation through 12-agent validation pipeline

3. **Institutional Testing Framework**
   - **Basic Test Suite**: Rapid development validation (25+ tests) with Code Quality Auditor oversight
   - **Enhanced Test Suite**: Production readiness validation (40+ tests) with full agent coordination
   - Quality gates require ≥90% pass rates with multi-agent validation chains

### Strategy Architecture Pattern
Each strategy follows this consistent multi-agent validated architecture:
```pinescript
//=====================================================================================================================
// STRATEGY CONFIGURATION - Input parameters grouped by function (Project Manager oversight)
//=====================================================================================================================

//=====================================================================================================================
// TECHNICAL INDICATORS & CALCULATIONS - All indicator calculations (PineScript Specialist validation)
//=====================================================================================================================

//=====================================================================================================================
// SIGNAL LOGIC - Market structure, MACD, filters (Market Structure Analyst + Crypto Specialist coordination)
//=====================================================================================================================

//=====================================================================================================================
// RISK MANAGEMENT - ATR-based positioning, trailing stops (Dynamic Risk Management oversight)
//=====================================================================================================================

//=====================================================================================================================
// STRATEGY EXECUTION - Entry/exit logic with comprehensive validation (Strategy Implementation coordination)
//=====================================================================================================================

//=====================================================================================================================
// TESTING FRAMEWORK - Dual test suites with quality gates (Look-Ahead Bias Detection + Performance Analyst validation)
//=====================================================================================================================

//=====================================================================================================================
// VISUALIZATION & MONITORING - Performance dashboards and alerts (Designer optimization)
//=====================================================================================================================
```

## Pine Script v6 Critical Requirements

### Mandatory Syntax Rules (PineScript Specialist Enforcement)
- **Single Line Statements**: No line continuation (`\`) - all statements must be single line
- **Function Call Pre-calculation**: All `ta.*`, `math.*` calls must be pre-calculated outside conditionals
- **Type History Syntax**: Use `(object[1]).field` NOT `object.field[1]` for user-defined types
- **Const Strings**: Plot functions require const strings, not series strings
- **Runtime Initialization**: Initialize all user-defined type fields on first bar (`bar_index == 0`)
- **Ternary Operator Usage**: Complex multi-line ternary operators must be single line - no line breaks

### Common Compilation Errors to Avoid (Code Quality Auditor Prevention)
- Line continuation errors (break long conditions into multiple statements)
- Function calls inside conditionals (pre-calculate all values)
- Incorrect type history syntax on custom types
- Series strings in plot functions (use const strings only)
- Uninitialized type field access (add first-bar initialization)
- Multi-line ternary operators (consolidate to single line)
- Function calls in conditional expressions causing inconsistent calculations

## Institutional Development Workflow

### Strategic Development Process (Multi-Agent Coordination)
1. **Strategic Analysis**: Context Manager coordination with existing strategy pattern review
2. **Project Planning**: Project Manager epic breakdown with milestone establishment
3. **Process Facilitation**: Agile Coach workflow optimization and impediment identification
4. **Technical Implementation**: PineScript Specialist Pine Script v6 compliance implementation
5. **Quality Validation**: Code Quality Auditor architectural compliance verification
6. **Risk Assessment**: Dynamic Risk Management risk protocol validation
7. **Performance Analysis**: Quantitative Performance Analyst statistical validation
8. **Bias Detection**: Look-Ahead Bias Detection temporal integrity verification
9. **Market Analysis**: Market Structure Analyst + Crypto Market Specialist coordination
10. **Strategy Implementation**: Strategy Implementation systematic execution validation
11. **Visualization Optimization**: Designer presentation and interface optimization
12. **Institutional Documentation**: Context Manager comprehensive implementation guide creation

### Testing Lab Development (Specialized Agent Oversight)
1. **Strategic Experimental Implementation**: Context Manager coordination in `/testing-lab/`
2. **Project-Managed Paper Trading**: Project Manager oversight - no live trading until graduation
3. **Agile Process Validation**: Agile Coach specialized test suite coordination for experimental features
4. **Performance Analysis**: Quantitative Performance Analyst missed opportunity documentation and system improvement analysis
5. **Risk-Managed Enhancement**: Dynamic Risk Management multi-path signal systems, advanced filtering, smart exits
6. **Institutional Graduation Criteria**: 90%+ test pass rate + performance targets met + multi-agent risk validation
7. **Strategic Promotion**: Context Manager coordination for main repository promotion after full agent validation

## Market-Specific Configurations

### BTC/Crypto Strategies (5M Scalping) - Crypto Market Specialist Coordination
- **MACD Parameters**: 8,21,5 (crypto-optimized vs traditional 12,26,9)
- **EMA Ribbon**: 8,21,34 system for enhanced trend filtering
- **Risk Management**: 1.5-1.8% stops, 2.5-2.7% targets (Dynamic Risk Management oversight)
- **Advanced Filtering**: Multi-path signal detection, adaptive cooldowns, reversal exits (Market Structure Analyst coordination)
- **Filters**: Volume (1.3-1.5x avg) + EMA alignment + SMA context + signal strength
- **Performance Target**: 70-85% win rate with enhanced opportunity capture (Quantitative Performance Analyst validation)

### Multi-Asset Strategies (4H Swing) - Market Structure Analyst Coordination
- **Market Structure**: CHoCH, BOS, IDM detection with LuxAlgo methodology
- **Risk Management**: ATR-based dynamic positioning (1.5-3.0 multipliers) (Dynamic Risk Management coordination)
- **MACD Filter**: Traditional 12,26,9 with bullish/bearish confirmation
- **Performance Target**: 60-70% win rate with trailing stops (Strategy Implementation validation)

## Institutional Quality Standards

### Multi-Agent Deployment Criteria
```
Institutional Deployment Ready = 
    Overall Test Pass Rate ≥90% (Code Quality Auditor) AND
    Core Systems ≥90% (PineScript Specialist) AND
    Performance Validated (Quantitative Performance Analyst) AND
    Pine Script v6 Compliant (PineScript Specialist) AND
    Zero Compilation Errors (Code Quality Auditor) AND
    Risk Controls Validated (Dynamic Risk Management) AND
    Bias Testing Complete (Look-Ahead Bias Detection) AND
    Market Analysis Confirmed (Market Structure Analyst) AND
    Strategic Approval (Context Manager + Project Manager) AND
    Process Compliance (Agile Coach)
```

### Testing Lab Graduation (Multi-Agent Validation)
```
Institutional Graduation Ready = 
    Experimental Validation ≥90% (Code Quality Auditor) AND
    Transformation Goals Met (Project Manager) AND
    Paper Trading Validated (Strategy Implementation) AND
    Safety Protocols Complete (Dynamic Risk Management) AND
    Bias Testing Complete (Look-Ahead Bias Detection) AND
    Performance Benchmarks Met (Quantitative Performance Analyst) AND
    Strategic Alignment Confirmed (Context Manager)
```

## Important Development Guidelines

### Pine Script v6 Compliance (PineScript Specialist Critical Oversight)
- Always coordinate with PineScript Specialist for detailed Pine Script v6 requirements
- Validate ALL syntax rules simultaneously through Code Quality Auditor (cascading errors common)
- Test compilation on TradingView platform through PineScript Specialist before considering complete
- Implement runtime safety patterns for user-defined types with Code Quality Auditor validation

### Institutional Code Quality Standards (Multi-Agent Enforcement)
- Follow existing naming conventions and architectural patterns (Code Quality Auditor oversight)
- Implement comprehensive error handling and edge case validation (Dynamic Risk Management coordination)
- Maintain professional documentation standards (Context Manager oversight)
- Use modular, testable component design (Project Manager architectural guidance)

### Risk Management Implementation (Dynamic Risk Management Institutional Oversight)
- ATR-based dynamic position sizing required (Dynamic Risk Management validation)
- Multi-layer risk controls (daily, weekly, position limits) (Dynamic Risk Management coordination)
- Emergency stop procedures documented and tested (Dynamic Risk Management oversight)
- Real-time performance monitoring integrated (Quantitative Performance Analyst coordination)

## Educational Focus

This repository serves as both a production trading system and educational resource demonstrating **12-agent institutional ecosystem coordination** for:
- Professional Pine Script v6 development practices through specialized agent coordination
- Institutional-grade testing methodologies with multi-agent validation chains
- Advanced risk management system implementation through Dynamic Risk Management oversight
- Experimental strategy development workflows with strategic management tier guidance
- Transformation from complex to optimized trading systems through comprehensive agent collaboration

The emphasis is on learning through systematic multi-agent development, comprehensive institutional testing, and continuous improvement of trading strategy implementations through coordinated 12-agent ecosystem expertise.

## Agent Coordination Summary

**Strategic Management Tier**: Fletcher → Seldon → Herbie (MANDATORY FIRST CONSULTATION)
**Technical Implementation**: Bjarne → Margaret → Nassim → Andrew
**Market Analysis**: Wyckoff → Satoshi → Jim → Ray
**Quality Assurance**: Margaret → Nassim → Andrew → Jim
**Creative & Communication**: Athena → Margaret

All workflows must begin with strategic management tier consultation and proceed through appropriate specialized agent coordination chains for institutional-grade Pine Script v6 development excellence.